<!DOCTYPE html>
<html lang="en">
<head>
	<title>I'm Learning D3</title>
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
	<style>
		text {
			font-family: "Open Sans", sans-serif;
			font-size: 12px;
		}

		.axis {
		  font: 10px sans-serif;
		}

		.axis path,
		.axis line {
		  fill: none;
		  stroke: #000;
		  shape-rendering: crispEdges;
		}

		rect:hover{
			fill: red;
		}
	</style>
</head>
<body>
	<!-- Location for page elements. -->
<script>

	// Width and height of SVG
	var width = 150;
	var height = 175;

	// Margins to left and bottom of chart
	var margin = {left: 50, bottom: 75};
	
	// Create SVG element
	var svg = d3.select("body")
		.append("svg")
		.attr("width", width)
		.attr("height", height);

	// Create Scale for Chart to dynamically scale by value
	var y = d3.scale.linear().range([height - margin.bottom, 0]);

	// Load External Data from CSV
	d3.csv("data/rat-data.csv", type, function(error, data) {
		y.domain([0, d3.max(data, function(d) { return d.rats; })]);

		var barWidth = 20;

		var bar = svg.selectAll("g")
			.data(data)
			.enter().append("g")
			.attr("transform", function(d, i) { return "translate(" + i*25 + ",0)"; });

		bar.append("rect")
			.attr("x", function(d) { return margin.left })
			.attr("y", function(d) { return y(d.rats); })
			.attr("height", function(d) { return height - margin.bottom - y(d.rats); })
			.attr("width", barWidth)
			.attr( "fill", "steelblue");

		bar.append("text")
			.attr("x", function(d) { return margin.left + barWidth / 2 })
			.attr("y", function(d) { return y(d.rats) + 4; })
			.attr("dy", "1em")
			.attr("fill", "white")
			.style("text-anchor", "middle")
			.text(function(d) { return d.rats; });

		bar.append("text")
			.attr("x", function(d) { return margin.left + barWidth })
			.attr("fill", "black")
			.attr("transform", "translate(65,175) rotate(-90)")
			.style("text-anchor", "end")
			.text(function(d) { return d.city; });

		svg.append("text")
			.attr("class", "y label")
			.attr("text-anchor", "middle")
			.text("No. of Rats")
			.attr("transform", "translate(20,50) rotate(-90)");

		svg.append("g")
		    .attr("class", "axis")
		    .attr("transform", "translate(" + margin.left + "," + (height - margin.bottom) + ")")
		    .call(xAxis);

		svg.append("g")
			.attr("class", "axis")
			.attr("transform", "translate(" + margin.left + ",0)")
			.call(yAxis);
		});

	function type(d) {
		d.rats = +d.rats; // coerce to number
		return d;
	}

	var x = d3.scale.ordinal().range([100, 0]);

	var xAxis = d3.svg.axis()
		.scale(x)
		.orient("bottom");

	var yAxis = d3.svg.axis()
	    .scale(y)
	    .orient("left")
	    .ticks(5);

</script>
</body>
</html>